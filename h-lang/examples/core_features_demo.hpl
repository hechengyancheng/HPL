// ============================================
// H语言核心功能演示脚本
// HPL Core Features Demo Script
// ============================================

// 1. 变量和赋值 (Variables and Assignment)
// ============================================

// 基本变量赋值
set playerName to "Alice"
set health to 100
set score to 0
set isAlive to true

// 全局变量（使用$前缀）
set $gameLevel to 1
set $totalScore to 0

// 2. 数据类型 (Data Types)
// ============================================

// 数字类型
set integer to 42
set floating to 3.14159
set negative to -10

// 字符串类型
set greeting to "Hello, World!"
set multiline to "Line 1\nLine 2\tTabbed"

// 布尔类型
set flagTrue to true
set flagFalse to false

// Null类型
set nothing to null

// 列表类型
set emptyList to []
set numbers to [1, 2, 3, 4, 5]
set fruits to ["apple", "banana", "cherry"]
set mixed to [1, "two", true, null, [1, 2]]

// 3. 算术运算 (Arithmetic Operations)
// ============================================

set sum to 10 + 20
set difference to 50 - 15
set product to 6 * 7
set quotient to 100 / 4
set remainder to 17 % 5
set negated to -42

// 复合运算
set complex to (10 + 5) * 2 - 3
echo "Complex calculation: " + complex

// 4. 比较运算 (Comparison Operations)
// ============================================

set a to 10
set b to 20

// 使用 "is" 进行比较
if a is 10:
    echo "a equals 10"

// 使用 "is not" 进行比较
if a is not b:
    echo "a is not equal to b"

// 使用 "is greater than" 进行比较
if b is greater than a:
    echo "b is greater than a"

// 使用 "is less than" 进行比较
if a is less than b:
    echo "a is less than b"

// 使用 "is at least" 进行比较（大于等于）
if b is at least 20:
    echo "b is at least 20"

// 使用 "is at most" 进行比较（小于等于）
if a is at most 10:
    echo "a is at most 10"

// 5. 逻辑运算 (Logical Operations)
// ============================================

set x to true
set y to false

// 逻辑与 (and)
if x and not y:
    echo "x is true AND y is false"

// 逻辑或 (or)
if x or y:
    echo "Either x or y is true"

// 逻辑非 (not)
if not y:
    echo "y is false"

// 组合逻辑
if (a is less than b) and (x or not y):
    echo "Complex logical expression is true"

// 6. 条件语句 (Conditional Statements)
// ============================================

set temperature to 25

// 简单的if语句
if temperature is greater than 30:
    echo "It's hot!"
else:
    echo "It's not too hot"

// if-else if-else 链
set grade to 85

if grade is greater than 90:
    echo "Grade: A"
else if grade is greater than 80:
    echo "Grade: B"
else if grade is greater than 70:
    echo "Grade: C"
else:
    echo "Grade: D or F"

// 7. 循环语句 (Loop Statements)
// ============================================

// while循环
set counter to 0
echo "While loop demonstration:"
while counter is less than 5:
    echo "Counter: " + counter
    increase counter by 1

// 使用increase/decrease
set health to 100
decrease health by 20
echo "Health after damage: " + health

increase health by 10
echo "Health after healing: " + health

// 8. 函数定义和调用 (Function Definition and Calling)
// ============================================

// 无参数函数
function sayHello:
    echo "Hello from function!"

sayHello()


// 带参数函数
function greet(name):
    echo "Hello, " + name + "!"

greet("World")
greet(playerName)

// 带返回值的函数
function add(a, b):
    return a + b

set result to add(10, 20)
echo "10 + 20 = " + result

// 复杂函数
function calculateDamage(baseDamage, defense):
    set actualDamage to baseDamage - defense
    if actualDamage is less than 0:
        set actualDamage to 0
    return actualDamage

set damage to calculateDamage(50, 15)
echo "Calculated damage: " + damage

// 递归函数示例（阶乘）
function factorial(n):
    if n is less than 2:
        return 1
    return n * factorial(n - 1)

set fact5 to factorial(5)
echo "5! = " + fact5

// 9. 列表操作 (List Operations)
// ============================================

set items to ["sword", "shield", "potion", "key"]

// 列表索引访问
echo "First item: " + items[0]
echo "Last item: " + items[3]

// 负索引（从末尾计数）
echo "Last item using negative index: " + items[-1]

// 列表长度
set itemCount to len(items)
echo "Number of items: " + itemCount

// 检查元素是否在列表中
if items contains "sword":
    echo "You have a sword!"

// 列表排序
set unsorted to [3, 1, 4, 1, 5, 9, 2, 6]
set sorted to sort(unsorted)
echo "Sorted: " + sorted

// 列表反转
set reversed to reverse(items)
echo "Reversed items: " + reversed

// 添加元素到列表
set expanded to append(items, "map")
echo "Expanded list: " + expanded

// 查找元素索引
set swordIndex to indexOf(items, "sword")
echo "Sword is at index: " + swordIndex

// 10. 字符串操作 (String Operations)
// ============================================

set message to "Hello, World!"

// 字符串长度
set msgLength to len(message)
echo "Message length: " + msgLength

// 转换大小写
set upperMsg to upper(message)
set lowerMsg to lower(message)
echo "Upper: " + upperMsg
echo "Lower: " + lowerMsg

// 检查包含关系
if contains(message, "World"):
    echo "Message contains 'World'"

// 检查前缀和后缀
if startsWith(message, "Hello"):
    echo "Message starts with 'Hello'"

if endsWith(message, "!"):
    echo "Message ends with '!'"

// 子字符串
set sub to substring(message, 7, 5)
echo "Substring: " + sub

// 字符串分割
set words to split(message, " ")
echo "Words: " + words

// 字符串替换
set replaced to replace(message, "World", "HPL")
echo "Replaced: " + replaced

// 去除空白
set padded to "  hello  "
set trimmed to trim(padded)
echo "Trimmed: '" + trimmed + "'"

// 11. 数学函数 (Math Functions)
// ============================================

set num to 3.7

// 取整函数
echo "Original: " + num
echo "Floor: " + floor(num)
echo "Ceil: " + ceil(num)
echo "Round: " + round(num)

// 绝对值
set negativeNum to -42
echo "Absolute value: " + abs(negativeNum)

// 最大值和最小值
echo "Max of 10, 20, 5: " + max(10, 20, 5)
echo "Min of 10, 20, 5: " + min(10, 20, 5)

// 平方根
set sqrtResult to sqrt(16)
echo "Square root of 16: " + sqrtResult

// 幂运算
set powResult to pow(2, 10)
echo "2^10 = " + powResult

// 随机数
set randomNum to random()
echo "Random number: " + randomNum


set randomInt to randomInt(1, 100)
echo "Random integer (1-100): " + randomInt

// 12. 类型转换 (Type Conversion)
// ============================================

// 转换为字符串
set numToStr to toString(42)
echo "Number as string: " + numToStr

// 转换为数字
set strToNum to toNumber("3.14159")
echo "String as number: " + strToNum

// 转换为布尔值
set strToBool to toBoolean("true")
set numToBool to toBoolean(1)
set zeroToBool to toBoolean(0)
echo "String 'true' as boolean: " + strToBool
echo "Number 1 as boolean: " + numToBool
echo "Number 0 as boolean: " + zeroToBool

// 转换为列表
set strToList to toList("hello")
echo "String as list: " + strToList

// 13. 嵌套数据结构 (Nested Data Structures)
// ============================================

// 嵌套列表
set matrix to [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

echo "Matrix row 0: " + matrix[0]
echo "Matrix element [1][2]: " + matrix[1][2]

// 14. 复杂表达式 (Complex Expressions)
// ============================================

set value1 to 10
set value2 to 20
set value3 to 30

// 复杂算术表达式
set complex1 to (value1 + value2) * value3 / 10 - 5
echo "Complex expression 1: " + complex1

// 复杂逻辑表达式
set condition1 to value1 is less than value2
set condition2 to value2 is less than value3
set condition3 to value1 is greater than 5

if condition1 and condition2 and condition3:
    echo "All conditions are true"

// 15. 综合示例：简单的游戏逻辑 (Comprehensive Example: Simple Game Logic)
// ============================================

echo "\n=== 游戏演示 ==="

// 初始化游戏状态
set $playerHealth to 100
set $playerMana to 50
set $inventory to ["sword", "potion"]
set $enemiesDefeated to 0

// 定义游戏函数
function takeDamage(damage):
    decrease $playerHealth by damage
    if $playerHealth is less than 0:
        set $playerHealth to 0
    echo "Player took " + damage + " damage. Health: " + $playerHealth

function heal(amount):
    increase $playerHealth by amount
    if $playerHealth is greater than 100:
        set $playerHealth to 100
    echo "Player healed " + amount + ". Health: " + $playerHealth

function addToInventory(item):
    set $inventory to append($inventory, item)
    echo "Added " + item + " to inventory"

function defeatEnemy(enemyName):
    increase $enemiesDefeated by 1
    echo "Defeated " + enemyName + "! Total: " + $enemiesDefeated

// 模拟游戏过程
echo "Initial health: " + $playerHealth
takeDamage(30)
heal(15)
addToInventory("shield")
defeatEnemy("Goblin")
defeatEnemy("Orc")

echo "Final inventory: " + $inventory
echo "Enemies defeated: " + $enemiesDefeated

// 16. 范围生成 (Range Generation)
// ============================================

set range1 to range(0, 5)
echo "Range 0-5: " + range1

set range2 to range(10, 0, -2)
echo "Range 10-0 step -2: " + range2

// 17. 类型检查 (Type Checking)
// ============================================

set testValue to "hello"
set typeName to type(testValue)
echo "Type of testValue: " + typeName

// 18. 列表连接 (List Joining)
// ============================================

set wordsList to ["Hello", "World", "from", "HPL"]
set joined to join(wordsList, " ")
echo "Joined words: " + joined

// 19. 最终总结输出 (Final Summary)
// ============================================

echo "\n========================================"
echo "HPL核心功能演示完成！"
echo "演示了以下功能："
echo "  - 变量和赋值"
echo "  - 数据类型（数字、字符串、布尔、null、列表）"
echo "  - 算术和比较运算"
echo "  - 逻辑运算"
echo "  - 条件语句（if/else if/else）"
echo "  - 循环（while）"
echo "  - 函数定义和调用"
echo "  - 列表操作"
echo "  - 字符串操作"
echo "  - 数学函数"
echo "  - 类型转换"
echo "  - 嵌套数据结构"
echo "========================================"
